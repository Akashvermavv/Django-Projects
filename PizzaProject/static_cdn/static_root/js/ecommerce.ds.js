function getCookie(name) {    let cookieValue = null;    if (document.cookie && document.cookie !== '') {        const cookies = document.cookie.split(';');        for (let i = 0; i < cookies.length; i++) {            const cookie = cookies[i].trim();            // Does this cookie string begin with the name we want?            if (cookie.substring(0, name.length + 1) === (name + '=')) {                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));                break;            }        }    }    return cookieValue;}const csrftoken = getCookie('csrftoken');$(document).ready(function(){var min_val;           var max_val;           console.log('min_max_form',$(".min_max_price"));           console.log('min value -->',$(".min_max_price  input.min_pricee").val());           min_val = $(".min_max_price  input.min_pricee").val()           max_val = $(".min_max_price  input.max_pricee").val()           console.log('max value -->',$(".min_max_price  input.max_pricee").val());           var category_=[];           console.log('hello');          $('.custom-control-input:checkbox:checked').each(function(){            //alert($(this).val())            category_.push($(this).val())          });          var new_products;          console.log('hellllllllllllllllllooooooooo')          console.log('jjjjj')          if(category_.length!=0 ){          getProductByCategory(category_,min_val,max_val)          }            // Contact Form Handler            var contactForm = $(".contact-form")            var contactFormMethod = contactForm.attr("method")            var contactFormEndpoint = contactForm.attr("action")            function displaySubmitting(submitBtn,defaultText,doSubmit){                    if (doSubmit){                            submitBtn.addClass("disabled")                            submitBtn.html("<i class='fa fa-spin fa-spinner'> </i> Sending...")                    }                    else{                        submitBtn.removeClass("disabled")                            submitBtn.html(defaultText)                    }            }            contactForm.submit(function(event){                    event.preventDefault()                    var contactFormSubmitBtn = contactForm.find("[type='submit']")                    var contactFormSubmitBtnTxt = contactFormSubmitBtn.text()                    var contactFormData = contactForm.serialize()                    var thisForm = $(this)                    displaySubmitting(contactFormSubmitBtn,"",true)                    $.ajax({                        method:contactFormMethod,                        url:contactFormEndpoint,                        data:contactFormData,                        success:function(data){                                contactForm[0].reset()                                $.alert({                                title:"Success!!",                                content:data.message,                                theme :"modern",                        })                            setTimeout(function(){                                displaySubmitting(contactFormSubmitBtn,contactFormSubmitBtnTxt,false)                            },500)                        },                        error:function(error){                            console.log('contact error --',error.responseJSON)                            var jsonData   = error.responseJSON                            var msg=""                            $.each(jsonData,function(key,value){             // dict --> key,value  if array index,object                                  msg += key + ": " + value[0].message + "<br/>"                            })                            $.alert({                                title:"Oops!!!",                                content:msg,                                theme :"modern",                            })                            setTimeout(function(){                                displaySubmitting(contactFormSubmitBtn,contactFormSubmitBtnTxt,false)                            },500)                        }                    })            })            // Auto Search            var searchForm = $(".search-form")            var searchInput = searchForm.find("[name='q']")  //  ex-- input name='q'  or div name='q'            var typingTimer;            var typingInterval = 1500  // 1.5 seconds            var searchBtn = searchForm.find("[type='submit']")                    searchInput.keyup(function(event){                        // key released                        clearTimeout(typingTimer)                        typingTimer = setTimeout(performSearch,typingInterval)                    })                    searchInput.keydown(function(event){                        // key pressed                        clearTimeout(typingTimer)                    })                    function displaySearching(){                            searchBtn.addClass("disabled")                            searchBtn.html("<i class='fa fa-spin fa-spinner'> </i> Searching...")                    }                    function performSearch(){                        displaySearching()                        var query = searchInput.val()                        //console.log(query);                        setTimeout(function(){                            window.location.href='/search/?q='+query                        },1000)                    }            // filter products by category          /* var filterCategoryForm = $("#update-products")     // for id    #form-product-ajax             $("#update-products").click(function(){             console.log('form--',$(this))             var selected = [];            $('#checkboxes input:checked').each(function() {                selected.push($(this).attr('name'));            });        alert("button",selected);    });*/            var categoryProduct;           function getProductByCategory(category1,min_val,max_val){                      var all_products  = $("#all_products")                      var product_count = $(".product_span_count")                      //console.log('all_products',all_products.html())                      all_products.html('')                    var actionEndpoint1 = '/get_category_wise_/'                    var httpMethod = 'POST'                    var data={                        category:category1,                        min_v :min_val,                        max_v : max_val                    }                    console.log('actionEndpoint1 --',actionEndpoint1)                    $.ajax({                                url:actionEndpoint1,                                method:httpMethod,                                data:data,                                success:function(data){                                        console.log('getOwnedProduct data --',data);                                        console.log('getOwnedProduct data.owner --',data.objs);                                        categoryProduct = data;                                        console.log('data ##### --',data);                                        console.log('category products ##### --',categoryProduct);                                        product_count.html(data.count);                                        $.each(data.objs,function(index,value){                                                    console.log('products --',value);                                                    console.log('name --',value.name);                                                    console.log('price --',value.price);                                                    console.log('image --',value.image);                                                    $('#all_products').append("<div class='col-6 col-md-6 col-lg-4 mb-3 '><div class='card h-100 border-0'><div class='card-img-top my-5'><a href='"+value.absolute_url+"'><img src='"+value.image+"' class='img-fluid mx-auto d-block img1' alt='Card image cap'></a></div><div class='card-body text-center'><h4 class='card-title'><span class='font-weight-bold text-dark text-uppercase small'>"+value.name+"</span></h4><h5 class='card-price small text-warning'><i style='color:black;'>"+value.price+"</i></h5></div><div class='text-center'><a href='"+value.absolute_url+"' class='btn btn-primary my-2'>View</a><form  method='POST' action='/cart/update' class='form form-product-ajax' data-endpoint='/cart/update' " +  (value.is_authenticated == true? "data-user='abc' " : "")+ "><input type='hidden' name='product_id' value='"+value.id+"'  " +  (value.is_digital == true? " data-is-digital='true' " : "")+ " /><span class='submit-span'>"+  (value.product_in_cart == true? "<div class='btn-group'><a class='btn btn-link' href ='/cart/'>In cart</a><button type='submit' class='btn btn-link'>Remove?</button></div>" : "<button type='submit' class='btn btn-success'>Add to Cart</button>")+"</span></form></div></div></div>");});                                            },                                        error:function(error){                                                    console.log('error in filter', error)                                                }                         })                       console.log('before return category product is ---',categoryProduct)                       $('#checkboxes input:checkbox').prop('checked', false);                       //return categoryProduct;            }           $("#update-products").click(function(){           var min_val;           var max_val;           console.log('min_max_form',$(".min_max_price"));           console.log('min value -->',$(".min_max_price  input.min_pricee").val());           min_val = $(".min_max_price  input.min_pricee").val()           max_val = $(".min_max_price  input.max_pricee").val()           console.log('max value -->',$(".min_max_price  input.max_pricee").val());           var category_=[];           console.log('hello');          $('.custom-control-input:checkbox:checked').each(function(){            //alert($(this).val())            category_.push($(this).val())          });          var new_products;          console.log('hellllllllllllllllllooooooooo')          console.log('jjjjj')          getProductByCategory(category_,min_val,max_val)          /*console.log('new products ---',new_products);           $.each(new_products,function(index,value){                    console.log('products --',value);          });*/ });          /* filterCategoryForm.click(function(event){           console.log('filterCategoryForm click ')           })*/            // cart + Add Products           var productForm = $(".form-product-ajax")     // for id    #form-product-ajax           function getOwnedProduct(productId,submitSpan){                    var actionEndpoint = '/orders/endpoint/verify/ownership/'                    var httpMethod = 'GET'                    var data={                        product_id:productId                    }                    var isOwner;                    $.ajax({                        url:actionEndpoint,                        method:httpMethod,                        data:data,                        success:function(data){                        console.log('getOwnedProduct data --',data)                        console.log('getOwnedProduct data.owner --',data.owner)                        if (data.owner){                            isOwner = true                            submitSpan.html("<a class='btn btn-warning' href='/library/'>In Library</a>")                        }                        else{                            isOwner = false                        }                            },                        error:function(error){                        console.log('error in getOwnedProduct', error)                        }           })           return isOwner           }           $.each(productForm,function(index,object){                    var $this = $(this)                    var isUser = $this.attr("data-user")                    var submitSpan = $this.find(".submit-span")                    var productInput = $this.find("[name='product_id']")                    var productId = productInput.attr("value")                    var productIsDigital = productInput.attr("data-is-digital")                    if (productIsDigital && isUser){                            var isOwned  = getOwnedProduct(productId,submitSpan)                    }           })           productForm.submit(function(event){                    event.preventDefault();                    console.log("form is stopped");                    var thisForm = $(this);                    var actionEndpoint = thisForm.attr("action");                    var httpMethod = thisForm.attr("method");                    var formData = thisForm.serialize();                    $.ajax({                        url:actionEndpoint,                        method:httpMethod,                        data:formData,                        success:function(data){                              console.log("success")                              console.log(data)                              console.log("Added",data.added)                              console.log("Removed",data.removed)                              var submitSpan = thisForm.find(".submit-span")                              //console.log(submitSpan.html())                              if(data.added){                                    submitSpan.html('  <div class="btn-group"> <a class="btn btn-link" href ="/cart/">In cart</a> <button type="submit" class="btn btn-link">Remove?</button> </div>')                                }                                else{                                    submitSpan.html('<button type="submit" class="btn btn-success">Add to Cart</button>')                                }                              var navbarCount = $(".navbar-cart-count")                              navbarCount.text(data.cartItemCount)                              var currentPath = window.location.href                              if (currentPath.indexOf("cart") != -1){                                    refreshCart()                              }                        },                        error:function(errorData){                        //$.alert('An error Occured');                        $.alert({                                title:"Oops!!!",                                content:"An error occurred",                                theme :"modern",                        })                                console.log("error")                                console.log(errorData)                        }                    })           })           function refreshCart(){                console.log("in current cart")                var cartTable  = $(".cart-table")                var cartBody   = cartTable.find(".cart-body")                //cartBody.html("<h1>Changed </h1>")                var productRows  = cartBody.find(".cart-product")                var currentUrl = window.location.href                var refreshCartUrl = '/api/cart/'                var refreshCartMethod = "GET";                var data ={};                $.ajax({                    url:refreshCartUrl,                    method:refreshCartMethod,                    data:data,                    success:function(data){                             var hiddenCartItemRemoveForm = $(".cart-item-remove-form")                            //console.log("success")                            //console.log(data)                            if(data.products.length > 0){                                    productRows.html(" ")                                    i=data.products.length                                    $.each(data.products,function(index,value){                                        console.log(value,i)                                        var newCartItemRemove = hiddenCartItemRemoveForm.clone()                                        newCartItemRemove.css("display","block")                                        //newCartItemRemove.removeClass("hidden-class")                                        newCartItemRemove.find(".cart-item-product-id").val(value.id)                                        cartBody.prepend("<tr><th scope=\"row\">"+ i +  "</th><td><a href='"+value.url+"'>"+                                                    value.name+"</a>"+  newCartItemRemove.html()  +"</td><td>"+  value.price +     "</td></tr>")                                      i--                                    })                                    cartBody.find(".cart-subtotal").text(data.subtotal)                                    cartBody.find(".cart-total").text(data.total)                            }                            else{                                window.location.href = currentUrl                            }                    },                    error:function(errorData){                     $.alert({                                title:"Oops!!!",                                content:"An error occurred",                                theme :"modern",                        })                            console.log("error")                            console.log(errorData)                            }                    })           }    })  $('.uncheck-all').on('click', function() {  //console.log('uncheck all class call')  //  $('.checkboxes input:checkbox').prop('checked', false);  });